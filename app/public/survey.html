<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Friend or Foe Survey</title>
  <!-- Latest compiled CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://kit.fontawesome.com/eda450702a.js"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.17.0/jquery.validate.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>
<body>
<!-- survey has 10 questions. Each answer is on a scale of 1 to 5 based on how much the user agrees or disagrees with a question. -->
<div class="container">
    
    <h1><strong>Survey Questions</strong></h1>
    <hr>

    <h3><strong>Who are you?</strong></h3>
    <br>

    <form id="survey">
        <div class="form-group">
          <h5><label for="frenemyName">Your Name or Your Cat's Name Here:</label></h4>
          <input type="text" required id="frenemyName" class="form-control validate" name="frenemyName" placeholder="name required">

          <br>

          <h5><label for="photo">Link Yours or Your Cat's Photo Here:</label></h4>
          <input type="url" required id="photo" class="form-control validate" name="photo" placeholder="url required">
        </div>
    <hr>
        <div class="form-group">
          <h4><strong><label for="q1">1. Your favorite animal is a cat.</label></strong></h4>
          <select class="form-control question" id="q1">
            <option value="" disabled selected>Select One</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3 (No Opinion)</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
            <h4><strong><label for="q2">2. You wouldn't be able to live if cats didn't exist.</label></strong></h4>
            <select class="form-control question" id="q2">
              <option value="" disabled selected>Select One</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3 (Neutral)</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
           </select>
        </div>
        <div class="form-group">
            <h4><strong><label for="q3">3. Cats are the rulers of the universe, you just live in their world.</label></strong></h4>
            <select class="form-control question" id="q3">
              <option value="" disabled selected>Select One</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3 (Can't Make Up Your Mind)</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
          </div>
        <div class="form-group">
            <h4><strong><label for="q4">4. You rarely do something without thinking about cats.</label></strong></h4>
              <select class="form-control question" id="q4">
              <option value="" disabled selected>Select One</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3 (Stop being so wishy washy)</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>
        <div class="form-group">
            <h4><strong><label for="q5">5. Hoomans that like cats can rarely upset you.</label></strong></h4>
            <select class="form-control question" id="q5">
              <option value="" disabled selected>Select One</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3 (Pick a side)</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>
        <div class="form-group">
            <h4><strong><label for="q6">6. It is often very easy for you to relate to other hooman's cats.</label></strong></h4>
            <select class="form-control question" id="q6">
              <option value="" disabled selected>Select One</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3 (To agree or not to agree)</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
          </div>
        <div class="form-group">
            <h4><strong><label for="q7">7. Cats are purrrfect creatures.</label></strong></h4>
            <select class="form-control question" id="q7">
              <option value="" disabled selected>Select One</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3 (Why can't you make up your mind?)</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
          </div>
          <div class="form-group">
              <h4><strong><label for="q8">8. You rarely forget the catnip.</label></strong></h4>
              <select class="form-control question" id="q8">
                <option value="" disabled selected>Select One</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3 (You have the power!)</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
          <div class="form-group">
              <h4><strong><label for="q9">9. You think that all cats are simply amazing and you cannot understand dog people.</label></strong></h4>
              <select class="form-control question" id="q9">
                <option value="" disabled selected>Select One</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3 (Just do it!)</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>
          <div class="form-group">
              <h4><strong><label for="q10">10. You feel more purrrfect when surrounded by cats and cat memes.</label></strong></h4>
              <select class="form-control question" id="q10">
                <option value="" disabled selected>Select One</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3 (The choice is obvious)</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

    <br>
    <br>
    <!-- Submit Button -->
    <button type="submit" class="btn btn-dark btn-lg btn-block" id="submit"><i class="fa fa-check-circle"></i>
     Submit</button>
    </form>
    
    <hr>

    <footer class="footer">
      <div class="container">
        <p><a href="/api/frenemies" class="text-dark">Frenemies List</a> | <a href="https://github.com/clearplaid/Friend-or-Foe" class="text-dark">GitHub Repo</a></p>
      </div>
    </footer>

    <!-- Modal -->
    <div class="modal fade" id="friend-modal" tabindex="-1" role="dialog" aria-labelledby="friend-modal" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">

            <div class="modal-header">
              <h1 class="modal-title" id="friend-modal-title"><strong>Friends, Are We?</strong></h1>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>

            <div class="modal-body">
              <h3>Keep your friends close...</h3>
              <h5 id="userFriend"></h5>
              <img id="userFriendImage" class="friend-image img-fluid" width="300" src="" alt="Friend"> 
              <hr>
              <h3>And your enemies closer!</h3>
              <h5 id="userEnemy"></h5>
              <img id="userEnemyImage" class="friend-image img-fluid" width="300" src="" alt="Enemy">   
            </div>

            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>

        </div>
      </div>
    </div>

</body>

<script type="text/javascript">
$(document).ready(function(){
  // $("#friend-modal").modal("hide");
  $("#friend-modal").modal({
        show: false,
        // Modal dismisses by clicking outside of it
        dismissible: false,
        // background opacity of modal 
        opacity: .5, 
        // Transition in duration
        inDuration: 200, 
        // Transition out duration
        outDuration: 200, 
      });
    });

    $("#submit").on("click", function (event){
        event.preventDefault();
        // validate form
        validateForm();

        function validateForm() {
            var valid = true;
            $.each($(".validate"), function (){
              if ($(this).val() === "") {
                valid = false;
              }
            });        
            $.each($(".question option:selected"), function() {
              if ($(this).val() === "") {
              valid = false;
              }
            });
            return valid;
          };

        if (validateForm()) {
            var userInput = {
                frenemyName: $("#frenemyName").val().trim(),
                photo: $("#photo").val().trim(),
                scores: []
            }
            $.each($(".question option:selected"), function(){
                userInput.scores.push($(this).val());
            });
          
            console.log(userInput);
            
            // this posts the new data to the frenemy api
            $.post("/api/frenemies", userInput).done(function(data) {
                console.log("data: " + JSON.stringify(data));
                // Once you've found the current user's most compatible friend, display the result as a modal pop-up.
          
                // The modal should display both the name and picture of the closest match.
                $("#userFriend").html(data.friendName);
                $("#userFriendImage").attr("src", data.friendImage);
                $("#userEnemy").html(data.enemyName);
                $("#userEnemyImage").attr("src", data.enemyImage);
                $("#friend-modal").modal({show: true});

                $("#survey").trigger("reset");
            });  
        }else {
          alert("Survey is incomplete, please fill in required fields!");
        };
    });

</script>

</html>

